import{j as r}from"./react-core-DkX7OQ4Q.js";import{c as g,e as x,b as y,a as d,F as C}from"./forms-CxDKTD82.js";import{C as l,h as j,s as c,i as w}from"./index-DUiqV2No.js";import{b as N,c as v}from"./useCategories-BsxxAxr3.js";import{b as S}from"./query-x6gLKhnn.js";import{a as T}from"./react-router-CdfMEooj.js";function K({category:t}){const u=T(),i=S(),{mutateAsync:p}=N(),{mutateAsync:m}=v(),n=!!t?.id,h=g({name:d().required("نام دسته‌بندی الزامی است"),description:d(),order:y().integer("ترتیب نمایش باید یک عدد صحیح باشد").min(0,"ترتیب نمایش نمی‌تواند منفی باشد"),published:x()}),b=async(e,a)=>{try{const s={name:e.name};if(e.description&&(s.description=e.description),e.order!==void 0&&e.order!==null&&(s.order=e.order),e.published!==void 0&&(s.published=e.published),n&&t?.id)await m({id:t.id,data:s}),c("دسته‌بندی با موفقیت ویرایش شد"),i.invalidateQueries({queryKey:["articleCategories"]}),i.invalidateQueries({queryKey:["articleCategory"]}),u("/admin/articles-category-management");else{await p(s),c("دسته‌بندی با موفقیت ایجاد شد"),a(),i.invalidateQueries({queryKey:["articleCategories"]}),i.invalidateQueries({queryKey:["articleCategory"]});const o=document.querySelector(".overflow-auto");o?o.scrollTo({top:0,behavior:"smooth"}):window.scrollTo({top:0,behavior:"smooth"})}}catch(s){const o=s?.response?.data?.message||(n?"خطایی در ویرایش دسته‌بندی رخ داد":"خطایی در ایجاد دسته‌بندی رخ داد");w(o)}};return r.jsx(C,{initialValues:{name:t?.name||"",description:t?.description||"",order:t?.order??0,published:t?.published??!0},validationSchema:h,onSubmit:async(e,{resetForm:a})=>{await b({name:e.name,description:e.description,order:Number(e.order),published:e.published},a)},children:e=>r.jsxs("form",{onSubmit:e.handleSubmit,className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 ",children:[r.jsx(l,{labelText:"نام دسته‌بندی",placeholder:"نام دسته‌بندی را وارد کنید",className:"bg-white",requiredText:!0,...e.getFieldProps("name"),errorMessage:e.touched.name&&e.errors.name?e.errors.name:null}),r.jsx(l,{labelText:"ترتیب نمایش",placeholder:"ترتیب نمایش را وارد کنید",optional:!0,className:"bg-white",name:"order",type:"number",value:e.values.order?.toString()||"0",onChange:a=>{const s=a.target.value;e.setFieldValue("order",s===""?0:parseInt(s,10))},onBlur:e.handleBlur,errorMessage:e.touched.order&&e.errors.order?e.errors.order:null})]}),r.jsx(j,{labelText:"توضیحات",placeholder:"توضیحات دسته‌بندی را وارد کنید",optional:!0,rows:4,className:"bg-white",...e.getFieldProps("description"),errorMessage:e.touched.description&&e.errors.description?e.errors.description:null}),r.jsx("div",{className:"flex items-center gap-4",children:r.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[r.jsx("input",{type:"checkbox",checked:e.values.published,onChange:a=>e.setFieldValue("published",a.target.checked),className:"w-5 h-5 rounded border-2 border-main-border-color text-primary focus:ring-primary"}),r.jsx("span",{className:"text-dark font-estedad-lightbold",children:"منتشر شده"})]})}),r.jsx("div",{className:"flex justify-end mt-6",children:r.jsxs("button",{type:"submit",className:"purple-btn flex items-center gap-2",disabled:e.isSubmitting,children:[n?"ویرایش دسته‌بندی":"ایجاد دسته‌بندی",e.isSubmitting&&r.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-white border-t-transparent"})]})})]})})}export{K as A};
