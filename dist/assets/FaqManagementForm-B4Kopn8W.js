import{c as x,j as r}from"./query-vendor-DvaUDqTV.js";import{u as g,a as w}from"./react-vendor-dTsWsAAn.js";import{c as q,e as y,b as j,a as n,F}from"./form-vendor--jwUxY8R.js";import{C as N,s as d,b as T}from"./index-D1LHzErR.js";import{C as l}from"./CustomTextArea-xgSORRfA.js";import{b as C,c as S}from"./useFaqs-ZHOPaAdd.js";function A({faq:s}){const u=g(),a=x(),{mutateAsync:c}=C(),{mutateAsync:p}=S(),i=!!s?.id,m=w.useMemo(()=>q({question:n().required("سوال الزامی است").min(10,"سوال باید حداقل ۱۰ کاراکتر باشد").max(500,"سوال نباید بیشتر از ۵۰۰ کاراکتر باشد"),answer:n().required("پاسخ الزامی است").min(10,"پاسخ باید حداقل ۱۰ کاراکتر باشد"),order:j().integer("ترتیب باید عدد صحیح باشد").min(0,"ترتیب نمی‌تواند منفی باشد"),published:y()}),[]),h=async(e,t)=>{try{if(i&&s?.id)await p({id:s.id,data:{question:e.question,answer:e.answer,order:e.order,published:e.published}}),d("سوال با موفقیت ویرایش شد"),a.invalidateQueries({queryKey:["faqs"]}),a.invalidateQueries({queryKey:["faq"]}),u("/admin/faqs-management");else{await c({question:e.question,answer:e.answer,order:e.order,published:e.published}),d("سوال با موفقیت ایجاد شد"),t(),a.invalidateQueries({queryKey:["faqs"]}),a.invalidateQueries({queryKey:["faq"]});const o=document.querySelector(".overflow-auto");o?o.scrollTo({top:0,behavior:"smooth"}):window.scrollTo({top:0,behavior:"smooth"})}}catch(o){const b=o?.response?.data?.message||(i?"خطایی در ویرایش سوال رخ داد":"خطایی در ایجاد سوال رخ داد");T(b)}};return r.jsx(F,{initialValues:{question:s?.question||"",answer:s?.answer||"",order:s?.order??0,published:s?.published??!0},validationSchema:m,onSubmit:async(e,{resetForm:t})=>{await h({question:e.question,answer:e.answer,order:e.order,published:e.published},t)},children:e=>r.jsxs("form",{onSubmit:e.handleSubmit,className:"space-y-4",children:[r.jsx(l,{labelText:"سوال",placeholder:"سوال را وارد کنید",className:"bg-white",requiredText:!0,rows:3,...e.getFieldProps("question"),errorMessage:e.touched.question&&e.errors.question?e.errors.question:null}),r.jsx(l,{labelText:"پاسخ",placeholder:"پاسخ را وارد کنید",requiredText:!0,rows:6,className:"bg-white",...e.getFieldProps("answer"),errorMessage:e.touched.answer&&e.errors.answer?e.errors.answer:null}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsx(N,{labelText:"ترتیب",placeholder:"ترتیب نمایش را وارد کنید",className:"bg-white",inputType:"number",...e.getFieldProps("order"),errorMessage:e.touched.order&&e.errors.order?e.errors.order:null}),r.jsx("div",{className:"flex items-center gap-4 pt-8",children:r.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[r.jsx("input",{type:"checkbox",checked:e.values.published,onChange:t=>e.setFieldValue("published",t.target.checked),className:"w-5 h-5 rounded border-2 border-main-border-color text-primary focus:ring-primary"}),r.jsx("span",{className:"text-dark font-estedad-lightbold",children:"منتشر شده"})]})})]}),r.jsx("div",{className:"flex justify-end mt-6",children:r.jsxs("button",{type:"submit",className:"purple-btn flex items-center gap-2",disabled:e.isSubmitting,children:[i?"ویرایش سوال":"ایجاد سوال",e.isSubmitting&&r.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-white border-t-transparent"})]})})]})})}export{A as F};
