import{b as x,j as s}from"./query-DkYU0mMV.js";import{c as g,r as w}from"./react-router-BDAfChV3.js";import{c as q,e as y,b as j,a as n,F}from"./forms-C2N9TMf6.js";import{am as N,an as T,k as d,C as S,s as l,l as C}from"./index-Ch14QAhQ.js";function K({faq:r}){const u=g(),a=x(),{mutateAsync:c}=N(),{mutateAsync:p}=T(),i=!!r?.id,h=w.useMemo(()=>q({question:n().required("سوال الزامی است").min(10,"سوال باید حداقل ۱۰ کاراکتر باشد").max(500,"سوال نباید بیشتر از ۵۰۰ کاراکتر باشد"),answer:n().required("پاسخ الزامی است").min(10,"پاسخ باید حداقل ۱۰ کاراکتر باشد"),order:j().integer("ترتیب باید عدد صحیح باشد").min(0,"ترتیب نمی‌تواند منفی باشد"),published:y()}),[]),m=async(e,t)=>{try{if(i&&r?.id)await p({id:r.id,data:{question:e.question,answer:e.answer,order:e.order,published:e.published}}),l("سوال با موفقیت ویرایش شد"),a.invalidateQueries({queryKey:["faqs"]}),a.invalidateQueries({queryKey:["faq"]}),u("/admin/faqs-management");else{await c({question:e.question,answer:e.answer,order:e.order,published:e.published}),l("سوال با موفقیت ایجاد شد"),t(),a.invalidateQueries({queryKey:["faqs"]}),a.invalidateQueries({queryKey:["faq"]});const o=document.querySelector(".overflow-auto");o?o.scrollTo({top:0,behavior:"smooth"}):window.scrollTo({top:0,behavior:"smooth"})}}catch(o){const b=o?.response?.data?.message||(i?"خطایی در ویرایش سوال رخ داد":"خطایی در ایجاد سوال رخ داد");C(b)}};return s.jsx(F,{initialValues:{question:r?.question||"",answer:r?.answer||"",order:r?.order??0,published:r?.published??!0},validationSchema:h,onSubmit:async(e,{resetForm:t})=>{await m({question:e.question,answer:e.answer,order:e.order,published:e.published},t)},children:e=>s.jsxs("form",{onSubmit:e.handleSubmit,className:"space-y-4",children:[s.jsx(d,{labelText:"سوال",placeholder:"سوال را وارد کنید",className:"bg-white",requiredText:!0,rows:3,...e.getFieldProps("question"),errorMessage:e.touched.question&&e.errors.question?e.errors.question:null}),s.jsx(d,{labelText:"پاسخ",placeholder:"پاسخ را وارد کنید",requiredText:!0,rows:6,className:"bg-white",...e.getFieldProps("answer"),errorMessage:e.touched.answer&&e.errors.answer?e.errors.answer:null}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsx(S,{labelText:"ترتیب",placeholder:"ترتیب نمایش را وارد کنید",className:"bg-white",inputType:"number",...e.getFieldProps("order"),errorMessage:e.touched.order&&e.errors.order?e.errors.order:null}),s.jsx("div",{className:"flex items-center gap-4 pt-8",children:s.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:e.values.published,onChange:t=>e.setFieldValue("published",t.target.checked),className:"w-5 h-5 rounded border-2 border-main-border-color text-primary focus:ring-primary"}),s.jsx("span",{className:"text-dark font-estedad-lightbold",children:"منتشر شده"})]})})]}),s.jsx("div",{className:"flex justify-end mt-6",children:s.jsxs("button",{type:"submit",className:"purple-btn flex items-center gap-2",disabled:e.isSubmitting,children:[i?"ویرایش سوال":"ایجاد سوال",e.isSubmitting&&s.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-white border-t-transparent"})]})})]})})}export{K as F};
