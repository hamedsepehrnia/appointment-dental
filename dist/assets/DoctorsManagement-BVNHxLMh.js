import{j as e,c as E}from"./query-vendor-DvaUDqTV.js";import{u as I,a as c}from"./react-vendor-dTsWsAAn.js";import{c as R,C as A,s as L,b as P}from"./index-aQCH0W4b.js";import{u as F}from"./useAdminDashboardHeader-CFWWO3br.js";import{b as _,u as O}from"./useDoctors-CBy2z0F9.js";import{A as q}from"./AdminPagination-4Dw6uLrF.js";import{T as B}from"./TableContainer-CEnoSnre.js";import{T as H,D as Q}from"./DeleteModal-6GmkfVBc.js";import{f as G}from"./helpers-DOyc9qlM.js";import{a as J}from"./index.module-BblzqiS0.js";import{D as K}from"./DoctorManagementForm-C_3ojszJ.js";import{S as z}from"./SectionContainer-Dtc5qGCy.js";import"./redux-vendor-5gwm_VuO.js";import"./ui-vendor-B68-Q-v-.js";import"./form-vendor--jwUxY8R.js";import"./motion-vendor-CQyDv_CV.js";import"./TextEditor-DgVFnTog.js";import"./editor-vendor-B7Ps43eN.js";function U(r){const s=R.c(15),{doctors:d,isLoadingDoctors:a,page:j,onDeleteClick:m,onRefetch:f,isRefetching:p}=r,u=p===void 0?!1:p,x=I();let l;s[0]!==u||s[1]!==f?(l=f&&e.jsx("div",{className:"mb-4 flex justify-end",children:e.jsxs("button",{onClick:f,disabled:u,className:"px-4 py-2 rounded-lg text-sm font-estedad-medium bg-primary/10 text-primary hover:bg-primary hover:text-white transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",title:"بروزرسانی لیست",children:[u?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-primary border-t-transparent"}):e.jsx("i",{className:"fas fa-sync-alt"}),"بروزرسانی"]})}),s[0]=u,s[1]=f,s[2]=l):l=s[2];let o;s[3]===Symbol.for("react.memo_cache_sentinel")?(o=e.jsx("thead",{className:"border-b border-main-border-color ",children:e.jsxs("tr",{className:"*:text-right *:p-4.5 *:text-nowrap",children:[e.jsx("th",{children:"ردیف"}),e.jsx("th",{children:"پزشک"}),e.jsx("th",{children:"دانشگاه"}),e.jsx("th",{children:"شماره نظام پزشکی"}),e.jsx("th",{children:"کلینیک‌ ها"}),e.jsx("th",{children:"تخصص‌ ها"}),e.jsx("th",{children:"تاریخ ایجاد"}),e.jsx("th",{children:"عملیات"})]})}),s[3]=o):o=s[3];let n;s[4]!==d||s[5]!==a||s[6]!==x||s[7]!==m||s[8]!==j?(n=a?e.jsx(H,{rows:5,columns:8}):d.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"text-center p-8 font-estedad-light",children:"پزشکی یافت نشد"})}):d.map((t,N)=>e.jsxs("tr",{className:"hover:bg-purple-400/10 text-dark *:p-4.5",children:[e.jsx("td",{className:"font-estedad-light text-center",children:(j-1)*5+N+1}),e.jsx("td",{className:"",children:e.jsxs("div",{className:"flex items-center gap-3 min-w-[220px] max-w-[220px]",children:[t.profileImage?e.jsx("img",{src:`${t.profileImage}`,alt:`${t.firstName} ${t.lastName}`,className:"w-12 h-12 rounded-full object-cover shrink-0"}):e.jsx("div",{className:"w-12 h-12 rounded-full bg-gray-200 flex items-center justify-center shrink-0",children:e.jsx("i",{className:"far fa-user text-gray-400"})}),e.jsx("div",{children:e.jsxs("p",{className:"font-estedad-light line-clamp-2  ",children:["دکتر ",t.firstName," ",t.lastName]})})]})}),e.jsx("td",{className:"text-dark font-estedad-light",children:e.jsx("div",{className:"line-clamp-2   min-w-[200px] ",children:t.university})}),e.jsx("td",{className:"text-dark font-estedad-light text-center",children:t.medicalLicenseNo}),e.jsx("td",{className:"text-dark font-estedad-light max-w-[260px]",children:t.clinics&&t.clinics.length>0?e.jsxs("div",{className:"flex justify-center items-start flex-wrap gap-1  ",children:[t.clinics.slice(0,2).map(W),t.clinics.length>2&&e.jsxs("span",{className:"px-2 py-1 text-xs rounded-full bg-gray-100 text-gray-600",children:["+",t.clinics.length-2]})]}):e.jsx("span",{className:"text-paragray",children:"-"})}),e.jsx("td",{className:"text-dark font-estedad-light",children:t.skills&&t.skills.length>0?e.jsxs("div",{className:"flex flex-wrap gap-1",children:[t.skills.slice(0,2).map(V),t.skills.length>2&&e.jsxs("span",{className:"px-2 py-1 text-xs rounded-full bg-gray-100 text-gray-600",children:["+",t.skills.length-2]})]}):e.jsx("span",{className:"text-paragray",children:"-"})}),e.jsx("td",{className:"text-dark font-estedad-light text-nowrap",children:G(new Date(t.createdAt||new Date))}),e.jsx("td",{className:"",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>{x(`/admin/doctors-management/edit/${t.id}`)},className:"p-1.5 rounded-full text-secondary bg-secondary/20 hover:bg-secondary hover:text-white transition",title:"ویرایش",children:e.jsx("i",{className:"far fa-edit"})}),e.jsx("button",{onClick:()=>m(t.id,t.firstName,t.lastName),className:"p-1.5 rounded-full text-red-500 bg-red-500/20 hover:bg-red-500 hover:text-white transition",title:"حذف",children:e.jsx("i",{className:"far fa-trash-alt"})})]})})]},t.id)),s[4]=d,s[5]=a,s[6]=x,s[7]=m,s[8]=j,s[9]=n):n=s[9];let i;s[10]!==n?(i=e.jsx(B,{withBg:!0,withMargin:!0,children:e.jsxs("table",{className:"w-full ",children:[o,e.jsx("tbody",{className:"divide-y divide-main-border-color",children:n})]})}),s[10]=n,s[11]=i):i=s[11];let g;return s[12]!==l||s[13]!==i?(g=e.jsxs(e.Fragment,{children:[l,i]}),s[12]=l,s[13]=i,s[14]=g):g=s[14],g}function V(r,s){return e.jsx("span",{className:"px-2 py-1 text-xs rounded-full bg-secondary/10 text-secondary text-center text-nowrap",children:r},s)}function W(r){return e.jsx("span",{className:"px-2 py-1 text-xs rounded-full bg-primary/10 text-primary text-center  text-nowrap",children:r.clinic.name},r.clinic.id)}function pe(){const{setHeaderConfig:r}=F(),[s,d]=c.useState(1),[a,j]=c.useState(""),[m]=J(a,500),[f,p]=c.useState(!1),[u,x]=c.useState(!1),[l,o]=c.useState(null),[n,i]=c.useState(!1),g=E(),{mutateAsync:t}=_(),{data:N,isLoading:b,isPending:v,refetch:D,isFetching:w}=O(s,5,m);c.useEffect(()=>(r({title:"مدیریت پزشکان"}),()=>{r({title:void 0,backButton:!1})}),[r]),c.useEffect(()=>{a.trim()?p(!0):p(!1)},[a]),c.useEffect(()=>{b||m===a&&p(!1)},[b,m,a]);const k=(h,y,$)=>{o({id:h,name:`${y} ${$}`}),x(!0)},C=async()=>{if(l){i(!0);try{await t(l.id),L("پزشک با موفقیت حذف شد"),g.invalidateQueries({queryKey:["doctors"]}),x(!1),o(null)}catch(h){const y=h?.response?.data?.message||"خطایی در حذف پزشک رخ داد";P(y)}finally{i(!1)}}},S=()=>{n||(x(!1),o(null))},T=N?.data?.doctors||[],M=N?.meta;return e.jsxs("main",{children:[e.jsxs(z,{children:[e.jsx("h5",{className:"main-header ",children:"لیست پزشکان"}),e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"relative max-w-md",children:[e.jsx(A,{labelText:"جستجو",placeholder:"جستجو بر اساس نام، نام خانوادگی یا بیوگرافی...",className:"bg-white pr-12",value:a,onChange:h=>{j(h.target.value),d(1)}}),f&&a&&e.jsx("div",{className:"absolute left-6 top-[calc(100%-38px)] flex items-center pointer-events-none",children:e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-primary border-t-transparent"})})]})}),e.jsx(U,{doctors:T,isLoadingDoctors:b||v,page:s,onDeleteClick:k,onRefetch:D,isRefetching:w}),e.jsx("div",{className:"mb-12 mt-6",children:e.jsx(q,{meta:M,onPageChange:h=>d(h)})}),e.jsx("hr",{className:"my-6 border-2 rounded-4xl border-gray-500"}),e.jsx(K,{})]}),e.jsx(Q,{isOpen:u,onClose:S,onConfirm:C,title:"حذف پزشک",message:`آیا از حذف دکتر ${l?.name} اطمینان دارید؟ این عمل غیرقابل بازگشت است.`,confirmText:"حذف",cancelText:"انصراف",isLoading:n})]})}export{pe as default};
