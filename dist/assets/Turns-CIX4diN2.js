import{b as A,j as e}from"./query-vendor-KlcNboas.js";import{c as D,D as P,E as B,m as c,l as R,h as S,i as I}from"./index-DIHBjxzH.js";import{a as L}from"./react-vendor-vqeg7uDR.js";import{M}from"./MainPagination-CHnbFFlU.js";import"./redux-vendor-CGnCw5VP.js";import"./ui-vendor-D4DdIvF_.js";import"./form-vendor--t6BffNT.js";import"./motion-vendor-CQyDv_CV.js";const _={PENDING:{label:"در انتظار بررسی",className:"bg-gray-100 text-gray-700",icon:"far fa-clock",iconBg:"bg-gray-200",iconColor:"text-gray-600"},APPROVED_BY_USER:{label:"در انتظار تأیید منشی",className:"bg-yellow-100 text-yellow-700",icon:"fa fa-hourglass-half",iconBg:"bg-yellow-200",iconColor:"text-yellow-600"},FINAL_APPROVED:{label:"تأیید شده",className:"bg-green-100 text-green-700",icon:"far fa-check-circle",iconBg:"bg-green-200",iconColor:"text-green-600"},CANCELED:{label:"لغو شده",className:"bg-red-100 text-red-700",icon:"far fa-times-circle",iconBg:"bg-red-200",iconColor:"text-red-600"}};function Y(){const s=D.c(22),[t,v]=L.useState(1),o=A();let d;s[0]!==t?(d={page:t,limit:10},s[0]=t,s[1]=d):d=s[1];const{data:m,isLoading:b,isError:w}=P(d),r=B();let x;s[2]!==m?.data?.appointments?(x=m?.data?.appointments||[],s[2]=m?.data?.appointments,s[3]=x):x=s[3];const f=x,y=m?.meta,z=$;let h;s[4]!==r||s[5]!==o?(h=async a=>{if(window.confirm("آیا از لغو این نوبت اطمینان دارید؟"))try{await r.mutateAsync({id:a}),o.invalidateQueries({queryKey:["myAppointments"]}),S("نوبت با موفقیت لغو شد")}catch(E){const i=E.response?.data?.message||"خطا در لغو نوبت";I(i)}},s[4]=r,s[5]=o,s[6]=h):h=s[6];const C=h;let g,p,N;s[7]===Symbol.for("react.memo_cache_sentinel")?(g={opacity:0,y:20},p={opacity:1,y:0},N={duration:.4},s[7]=g,s[8]=p,s[9]=N):(g=s[7],p=s[8],N=s[9]);let j;s[10]===Symbol.for("react.memo_cache_sentinel")?(j=e.jsx(c.div,{initial:g,animate:p,transition:N,children:e.jsx("h2",{className:"text-base font-bold text-dark mb-2",style:{fontFamily:"var(--font-vazir)"},children:"تاریخچه نوبت‌ها"})}),s[10]=j):j=s[10];let l;s[11]!==f||s[12]!==r||s[13]!==C||s[14]!==w||s[15]!==b?(l=b?e.jsx("div",{className:"space-y-3",children:[...Array(3)].map(T)}):w?e.jsx(c.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-xl shadow-sm border border-gray-100 p-8 text-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center",children:e.jsx("i",{className:"fas fa-exclamation-triangle text-red-500 text-2xl"})}),e.jsx("p",{className:"text-red-500 font-semibold",style:{fontFamily:"var(--font-vazir)"},children:"خطا در دریافت اطلاعات. لطفاً دوباره تلاش کنید."})]})}):f.length===0?e.jsx(c.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-xl shadow-sm border border-gray-100 p-8 text-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center",children:e.jsx("i",{className:"fas fa-calendar-times text-gray-400 text-2xl"})}),e.jsx("p",{className:"text-gray-500 font-semibold",style:{fontFamily:"var(--font-vazir)"},children:"نوبتی یافت نشد"})]})}):e.jsx("div",{className:"space-y-3",children:f.map((a,E)=>{const{date:F,time:k}=z(a.appointmentDate),i=_[a.status]||_.PENDING;return e.jsx(c.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,delay:E*.05},className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden hover:shadow-md transition-shadow",children:e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex items-center justify-center w-10 h-10 bg-accent/10 rounded-lg shrink-0",children:e.jsx("i",{className:"fas fa-user-md text-accent text-sm"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-0.5",style:{fontFamily:"var(--font-vazir)"},children:"پزشک"}),e.jsx("p",{className:"text-sm font-semibold text-dark",style:{fontFamily:"var(--font-vazir)"},children:a.doctor?e.jsxs(e.Fragment,{children:["دکتر ",a.doctor.firstName," ",a.doctor.lastName]}):e.jsx("span",{className:"text-gray-400 font-normal",children:"پزشک مشخص نشده"})})]}),e.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[e.jsx("div",{className:`flex items-center justify-center w-8 h-8 ${i.iconBg} rounded-lg`,children:e.jsx("i",{className:`${i.icon} ${i.iconColor} text-xs`})}),e.jsx("span",{className:`px-2.5 py-1 rounded-lg text-xs font-semibold ${i.className}`,style:{fontFamily:"var(--font-vazir)"},children:i.label})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex items-center justify-center w-10 h-10 bg-primary/10 rounded-lg shrink-0",children:e.jsx("i",{className:"fas fa-calendar-alt text-primary text-sm"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-0.5",style:{fontFamily:"var(--font-vazir)"},children:"تاریخ و زمان"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("p",{className:"text-sm font-semibold text-dark",style:{fontFamily:"var(--font-vazir)"},children:F}),e.jsx("span",{className:"text-xs text-accent font-medium",children:k})]})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex items-center justify-center w-10 h-10 bg-secondary/10 rounded-lg shrink-0",children:e.jsx("i",{className:"fas fa-hospital text-secondary text-sm"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-0.5",style:{fontFamily:"var(--font-vazir)"},children:"کلینیک"}),e.jsx("p",{className:"text-sm font-semibold text-dark",style:{fontFamily:"var(--font-vazir)"},children:a.clinic.name})]}),a.status!=="CANCELED"&&e.jsx("div",{className:"shrink-0",children:e.jsxs("button",{onClick:()=>C(a.id),disabled:r.isPending,className:"flex items-center gap-1.5 px-3 py-1.5 text-red-600 bg-red-50 hover:bg-red-100 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed text-xs font-semibold",style:{fontFamily:"var(--font-vazir)"},title:"لغو نوبت",children:[e.jsx("i",{className:"fas fa-times text-xs"}),e.jsx("span",{children:"لغو نوبت"})]})})]})]})})},a.id)})}),s[11]=f,s[12]=r,s[13]=C,s[14]=w,s[15]=b,s[16]=l):l=s[16];let n;s[17]!==y?(n=y&&e.jsx("div",{className:"mt-6",children:e.jsx(M,{meta:y,onPageChange:a=>v(a)})}),s[17]=y,s[18]=n):n=s[18];let u;return s[19]!==l||s[20]!==n?(u=e.jsxs("div",{className:"space-y-3",children:[j,l,n]}),s[19]=l,s[20]=n,s[21]=u):u=s[21],u}function T(s,t){return e.jsx(c.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,delay:t*.1},className:"bg-white rounded-xl shadow-sm border border-gray-100 p-4",children:e.jsx("div",{className:"animate-pulse space-y-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-200 rounded-lg"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/2"})]})]})})},t)}function $(s){const t=new Date(s),v=t.toLocaleTimeString("fa-IR",{hour:"2-digit",minute:"2-digit"});return{date:R(t),time:v}}export{Y as default};
