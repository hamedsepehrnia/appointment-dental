import{r as x,j as r}from"./react-core-DkX7OQ4Q.js";import{c as g,e as w,b as q,a as n,F as y}from"./forms-CxDKTD82.js";import{ah as j,ai as F,h as d,C as N,s as l,i as T}from"./index-DUiqV2No.js";import{b as S}from"./query-x6gLKhnn.js";import{a as C}from"./react-router-CdfMEooj.js";function $({faq:s}){const u=C(),a=S(),{mutateAsync:c}=j(),{mutateAsync:p}=F(),o=!!s?.id,h=x.useMemo(()=>g({question:n().required("سوال الزامی است").min(10,"سوال باید حداقل ۱۰ کاراکتر باشد").max(500,"سوال نباید بیشتر از ۵۰۰ کاراکتر باشد"),answer:n().required("پاسخ الزامی است").min(10,"پاسخ باید حداقل ۱۰ کاراکتر باشد"),order:q().integer("ترتیب باید عدد صحیح باشد").min(0,"ترتیب نمی‌تواند منفی باشد"),published:w()}),[]),m=async(e,t)=>{try{if(o&&s?.id)await p({id:s.id,data:{question:e.question,answer:e.answer,order:e.order,published:e.published}}),l("سوال با موفقیت ویرایش شد"),a.invalidateQueries({queryKey:["faqs"]}),a.invalidateQueries({queryKey:["faq"]}),u("/admin/faqs-management");else{await c({question:e.question,answer:e.answer,order:e.order,published:e.published}),l("سوال با موفقیت ایجاد شد"),t(),a.invalidateQueries({queryKey:["faqs"]}),a.invalidateQueries({queryKey:["faq"]});const i=document.querySelector(".overflow-auto");i?i.scrollTo({top:0,behavior:"smooth"}):window.scrollTo({top:0,behavior:"smooth"})}}catch(i){const b=i?.response?.data?.message||(o?"خطایی در ویرایش سوال رخ داد":"خطایی در ایجاد سوال رخ داد");T(b)}};return r.jsx(y,{initialValues:{question:s?.question||"",answer:s?.answer||"",order:s?.order??0,published:s?.published??!0},validationSchema:h,onSubmit:async(e,{resetForm:t})=>{await m({question:e.question,answer:e.answer,order:e.order,published:e.published},t)},children:e=>r.jsxs("form",{onSubmit:e.handleSubmit,className:"space-y-4",children:[r.jsx(d,{labelText:"سوال",placeholder:"سوال را وارد کنید",className:"bg-white",requiredText:!0,rows:3,...e.getFieldProps("question"),errorMessage:e.touched.question&&e.errors.question?e.errors.question:null}),r.jsx(d,{labelText:"پاسخ",placeholder:"پاسخ را وارد کنید",requiredText:!0,rows:6,className:"bg-white",...e.getFieldProps("answer"),errorMessage:e.touched.answer&&e.errors.answer?e.errors.answer:null}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsx(N,{labelText:"ترتیب",placeholder:"ترتیب نمایش را وارد کنید",className:"bg-white",inputType:"number",...e.getFieldProps("order"),errorMessage:e.touched.order&&e.errors.order?e.errors.order:null}),r.jsx("div",{className:"flex items-center gap-4 pt-8",children:r.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[r.jsx("input",{type:"checkbox",checked:e.values.published,onChange:t=>e.setFieldValue("published",t.target.checked),className:"w-5 h-5 rounded border-2 border-main-border-color text-primary focus:ring-primary"}),r.jsx("span",{className:"text-dark font-estedad-lightbold",children:"منتشر شده"})]})})]}),r.jsx("div",{className:"flex justify-end mt-6",children:r.jsxs("button",{type:"submit",className:"purple-btn flex items-center gap-2",disabled:e.isSubmitting,children:[o?"ویرایش سوال":"ایجاد سوال",e.isSubmitting&&r.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-white border-t-transparent"})]})})]})})}export{$ as F};
