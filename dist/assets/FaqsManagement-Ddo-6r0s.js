import{j as e,b as S}from"./query-vendor-KlcNboas.js";import{c as v,N as T,s as M,l as L,T as R,G as P,S as $,Q as A,R as E,h as O,i as _}from"./index-D-ec5iYs.js";import{e as B,a as f}from"./react-vendor-vqeg7uDR.js";import{a as H,u as I}from"./useFaqs-PHd0-6Zd.js";import{F as Q}from"./FaqManagementForm-CDMJDafo.js";import{S as G,c as J}from"./ui-vendor-D4DdIvF_.js";import"./redux-vendor-CGnCw5VP.js";import"./motion-vendor-CQyDv_CV.js";import"./form-vendor--t6BffNT.js";function K(l){const t=v.c(15),{faqs:s,isLoadingFaqs:a,page:g,onDeleteClick:j,onRefetch:d,isRefetching:m}=l,c=m===void 0?!1:m,x=B();let i;t[0]!==c||t[1]!==d?(i=d&&e.jsx("div",{className:"mb-4 flex justify-end",children:e.jsxs("button",{onClick:d,disabled:c,className:"px-4 py-2 rounded-lg text-sm font-estedad-medium bg-primary/10 text-primary hover:bg-primary hover:text-white transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",title:"بروزرسانی لیست",children:[c?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-primary border-t-transparent"}):e.jsx("i",{className:"fas fa-sync-alt"}),"بروزرسانی"]})}),t[0]=c,t[1]=d,t[2]=i):i=t[2];let u;t[3]===Symbol.for("react.memo_cache_sentinel")?(u=e.jsx("thead",{className:"border-b border-main-border-color ",children:e.jsxs("tr",{className:"*:text-right *:p-4.5 *:text-nowrap",children:[e.jsx("th",{children:"ردیف"}),e.jsx("th",{children:"سوال"}),e.jsx("th",{children:"پاسخ"}),e.jsx("th",{children:"ترتیب"}),e.jsx("th",{children:"وضعیت"}),e.jsx("th",{children:"تاریخ ایجاد"}),e.jsx("th",{children:"عملیات"})]})}),t[3]=u):u=t[3];let h;t[4]!==s||t[5]!==a||t[6]!==x||t[7]!==j||t[8]!==g?(h=a?e.jsx(T,{rows:5,columns:7}):s.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"text-center p-8 font-estedad-light",children:"سوالی یافت نشد"})}):s.map((n,w)=>e.jsxs("tr",{className:"hover:bg-purple-400/10 text-dark *:p-4.5",children:[e.jsx("td",{className:"font-estedad-light text-center",children:(g-1)*5+w+1}),e.jsx("td",{className:"",children:e.jsx("p",{className:"font-estedad-light line-clamp-2 max-w-[300px] min-w-[220px]",children:n.question})}),e.jsx("td",{className:"text-dark font-estedad-light",children:e.jsx("span",{className:"line-clamp-2 max-w-[300px] min-w-[220px]",children:M(n.answer)})}),e.jsx("td",{className:"text-dark font-estedad-light text-center",children:n.order}),e.jsx("td",{className:"text-dark font-estedad-light",children:n.published?e.jsx("span",{className:"px-2 py-1 text-xs rounded-full bg-green-100 text-green-700 text-nowrap",children:"منتشر شده"}):e.jsx("span",{className:"px-2 py-1 text-xs rounded-full bg-yellow-100 text-yellow-700 text-nowrap",children:"پیش‌نویس"})}),e.jsx("td",{className:"text-dark font-estedad-light text-nowrap",children:L(new Date(n.createdAt||new Date))}),e.jsx("td",{className:"",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>{x(`/admin/faqs-management/edit/${n.id}`)},className:"p-1.5 rounded-full text-secondary bg-secondary/20 hover:bg-secondary hover:text-white transition",title:"ویرایش",children:e.jsx("i",{className:"far fa-edit"})}),e.jsx("button",{onClick:()=>j(n.id,n.question),className:"p-1.5 rounded-full text-red-500 bg-red-500/20 hover:bg-red-500 hover:text-white transition",title:"حذف",children:e.jsx("i",{className:"far fa-trash-alt"})})]})})]},n.id)),t[4]=s,t[5]=a,t[6]=x,t[7]=j,t[8]=g,t[9]=h):h=t[9];let o;t[10]!==h?(o=e.jsx(R,{withBg:!0,withMargin:!0,children:e.jsxs("table",{className:"w-full ",children:[u,e.jsx("tbody",{className:"divide-y divide-main-border-color",children:h})]})}),t[10]=h,t[11]=o):o=t[11];let p;return t[12]!==i||t[13]!==o?(p=e.jsxs(e.Fragment,{children:[i,o]}),t[12]=i,t[13]=o,t[14]=p):p=t[14],p}const W=l=>{const t=v.c(3);let s;t[0]===Symbol.for("react.memo_cache_sentinel")?(s=e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M5 7.5L10 12.5L15 7.5",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),t[0]=s):s=t[0];let a;return t[1]!==l?(a=e.jsx(J.DropdownIndicator,{...l,children:s}),t[1]=l,t[2]=a):a=t[2],a},N=[{value:"",label:"همه"},{value:"true",label:"منتشر شده"},{value:"false",label:"پیش‌نویس"}];function ae(){const{setHeaderConfig:l}=P(),[t,s]=f.useState(1),[a,g]=f.useState(""),[j,d]=f.useState(!1),[m,c]=f.useState(null),[x,i]=f.useState(!1),u=S(),{mutateAsync:h}=H(),{data:o,isLoading:p,isPending:n,refetch:w,isFetching:y}=I(t,5,a||void 0);f.useEffect(()=>(l({title:"مدیریت سوالات متداول"}),()=>{l({title:void 0,backButton:!1})}),[l]);const k=(r,b)=>{c({id:r,question:b}),d(!0)},F=async()=>{if(m){i(!0);try{await h(m.id),O("سوال با موفقیت حذف شد"),u.invalidateQueries({queryKey:["faqs"]}),d(!1),c(null)}catch(r){const b=r?.response?.data?.message||"خطایی در حذف سوال رخ داد";_(b)}finally{i(!1)}}},C=()=>{x||(d(!1),c(null))},D=o?.data?.faqs||[],q=o?.meta;return e.jsxs("main",{children:[e.jsxs($,{children:[e.jsx("h5",{className:"main-header ",children:"لیست سوالات متداول"}),e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"relative max-w-md",children:[e.jsx("label",{className:"block text-dark font-estedad-lightbold mb-2 mr-4",children:"فیلتر بر اساس وضعیت"}),e.jsx(G,{options:N,value:N.find(r=>r.value===a)||N[0],onChange:r=>{g(r?.value||""),s(1)},placeholder:"انتخاب وضعیت",components:{DropdownIndicator:W},classNames:{control:()=>"!text-dark px-5 !min-h-[52px] !rounded-lg !border-2 !border-main-border-color !focus:outline-none h-full !cursor-pointer",option:({isFocused:r,isSelected:b})=>`px-3 py-2 cursor-pointer !text-lg border-r-6 ${b?"!bg-primary text-white !cursor-pointer":r?"!text-secondary !cursor-pointer":"bg-white !cursor-pointer"}`,menu:()=>"!mt-0 !rounded-t-none shadow-lg bg-white overflow-hidden",placeholder:()=>"!text-dark"}})]})}),e.jsx(K,{faqs:D,isLoadingFaqs:p||n,page:t,onDeleteClick:k,onRefetch:w,isRefetching:y}),e.jsx("div",{className:"mb-12 mt-6",children:e.jsx(A,{meta:q,onPageChange:r=>s(r)})}),e.jsx("hr",{className:"my-6 border-2 rounded-4xl border-gray-500"}),e.jsx(Q,{})]}),e.jsx(E,{isOpen:j,onClose:C,onConfirm:F,title:"حذف سوال",message:`آیا از حذف سوال "${m?.question}" اطمینان دارید؟ این عمل غیرقابل بازگشت است.`,confirmText:"حذف",cancelText:"انصراف",isLoading:x})]})}export{ae as default};
