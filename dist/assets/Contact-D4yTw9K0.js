import{c as I,j as e}from"./query-vendor-DvaUDqTV.js";import{m as g,C as h,s as b,b as y,c as j,d as f,f as S}from"./index-J2TYnO22.js";import{B as C}from"./Breadcrumb-ChH4UYAv.js";import{F as w,c as N,b as F,a as p}from"./form-vendor--jwUxY8R.js";import{C as v}from"./CustomTextArea-C__Mc83G.js";import{a as M}from"./useReviews-BkucxDxD.js";import{L as T,T as q,P as _,M as P,a as V}from"./map-vendor-BAXXUa8o.js";import{u as $}from"./useContact-C0mXmkRc.js";import{h as L,i as A}from"./ui-vendor-B68-Q-v-.js";import{a as z}from"./react-vendor-dTsWsAAn.js";import"./redux-vendor-5gwm_VuO.js";import"./motion-vendor-CQyDv_CV.js";function D(){const{mutateAsync:a,isPending:s}=M(),n=I(),i=async(r,t)=>{try{const l=new FormData;l.append("name",r.name),l.append("content",r.content),l.append("rating",r.rating.toString()),r.profileImage&&l.append("profileImage",r.profileImage);const o=await a(l);b(o.message||"نظر شما با موفقیت ثبت شد. پس از تایید ادمین نمایش داده خواهد شد."),n.invalidateQueries({queryKey:["reviews"]}),t()}catch(l){console.log(l),y("خطایی در ثبت نظر رخ داد")}};return e.jsx("section",{className:"py-12 overflow-x-hidden ",children:e.jsxs("div",{className:"container mx-auto px-4 overflow-y-hidden",children:[e.jsxs(g.div,{className:"text-center mb-8",initial:{opacity:0,y:-20},whileInView:{opacity:1,y:0},transition:{duration:.6},viewport:{once:!0},children:[e.jsx("h2",{className:"text-3xl md:text-4xl font-estedad-bold text-dark mb-3",children:"دیدگاه خود را ثبت کنید"}),e.jsx("p",{className:"text-paragray text-base md:text-lg max-w-2xl mx-auto",children:"نظرات و پیشنهادات شما برای ما ارزشمند است"})]}),e.jsx("div",{className:"max-w-3xl mx-auto",children:e.jsx(g.div,{className:"bg-white rounded-2xl shadow-lg p-6 md:p-8 border border-gray-100",initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.6,ease:"easeOut"},viewport:{once:!0,amount:.3},children:e.jsx(w,{initialValues:{name:"",content:"",rating:5,profileImage:null},onSubmit:(r,{resetForm:t})=>i(r,t),validationSchema:N({name:p().required("نام الزامی است"),content:p().required("متن نظر الزامی است").min(10,"متن نظر باید حداقل 10 کاراکتر باشد"),rating:F().required("امتیاز الزامی است").min(1,"امتیاز باید بین 1 تا 5 باشد").max(5,"امتیاز باید بین 1 تا 5 باشد")}),children:r=>e.jsxs("form",{onSubmit:r.handleSubmit,className:"space-y-4",children:[e.jsx(h,{labelText:"نام",placeholder:"نام خود را وارد کنید",requiredText:!0,...r.getFieldProps("name"),errorMessage:r.touched.name&&r.errors.name?r.errors.name:null}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-dark font-estedad-lightbold mb-2 mr-4",children:["امتیاز",e.jsx("span",{className:"text-red-500 mr-1",children:"*"})]}),e.jsxs("div",{className:"flex items-center gap-2 mr-4",children:[[1,2,3,4,5].map(t=>e.jsx("button",{type:"button",onClick:()=>r.setFieldValue("rating",t),className:`text-2xl transition-colors ${t<=r.values.rating?"text-secondary":"text-gray-300"} hover:text-secondary`,children:e.jsx("i",{className:"fas fa-star"})},t)),e.jsxs("span",{className:"text-paragray text-sm mr-2",children:["(",r.values.rating," از 5)"]})]}),r.touched.rating&&r.errors.rating&&e.jsx("div",{className:"text-red-500 text-sm mt-1 mr-4",children:r.errors.rating})]}),e.jsx(v,{labelText:"متن نظر",placeholder:"نظر خود را بنویسید...",rows:5,requiredText:!0,className:"min-h-[120px] w-full",...r.getFieldProps("content"),errorMessage:r.touched.content&&r.errors.content?r.errors.content:null}),e.jsx("div",{children:e.jsx(h,{inputType:"file",labelText:"تصویر پروفایل (اختیاری)",placeholder:"تصویر پروفایل را انتخاب کنید",optional:!0,accept:"image/*",onChange:t=>{const l=t.target.files?.[0]||null;r.setFieldValue("profileImage",l)},errorMessage:r.touched.profileImage&&r.errors.profileImage?r.errors.profileImage:null})}),e.jsx("button",{type:"submit",className:"w-full main-btn mt-6",disabled:s,children:s?e.jsx("div",{className:"btn-loader"}):"ثبت نظر"})]})})})})]})})}const O=new T.Icon({iconUrl:"/images/leaflet/marker-icon.png",shadowUrl:"/images/leaflet/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34]});function R(a){const s=j.c(18),{clinic:n}=a,i=n?.latitude!=null&&n?.longitude!=null;let r;s[0]!==n||s[1]!==i?(r=i?[n.latitude,n.longitude]:[35.6892,51.389],s[0]=n,s[1]=i,s[2]=r):r=s[2];const t=r;let l;s[3]===Symbol.for("react.memo_cache_sentinel")?(l=e.jsx(q,{attribution:'© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),s[3]=l):l=s[3];const o=n?.name||"کلینیک دندانپزشکی";let d;s[4]!==o?(d=e.jsx(_,{children:o}),s[4]=o,s[5]=d):d=s[5];let m;s[6]!==t||s[7]!==d?(m=e.jsx(P,{position:t,icon:O,children:d}),s[6]=t,s[7]=d,s[8]=m):m=s[8];let c;s[9]!==t||s[10]!==m?(c=e.jsxs(V,{className:"w-full h-full min-h-[370px] rounded-t-2xl z-10 flex-1",center:t,zoom:15,scrollWheelZoom:!0,children:[l,m]}),s[9]=t,s[10]=m,s[11]=c):c=s[11];let x;s[12]!==n||s[13]!==t?(x=n&&e.jsxs("div",{className:"bg-white rounded-b-2xl border-t-0 border border-gray-200 p-5 flex flex-col gap-3 shadow-sm",children:[e.jsx("h3",{className:"font-estedad-bold text-lg text-dark mb-1",children:n.name}),n.description&&e.jsx("p",{className:"text-sm text-paragray leading-relaxed line-clamp-2 mb-3",children:n.description}),e.jsx("div",{className:"w-full h-px bg-gray-200 my-2"}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-50 rounded-lg flex items-center justify-center shrink-0",children:e.jsx("i",{className:"fas fa-map-marker-alt text-blue-500 text-sm"})}),e.jsx("p",{className:"text-sm text-paragray flex-1 leading-relaxed",children:n.address})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-green-50 rounded-lg flex items-center justify-center shrink-0",children:e.jsx("i",{className:"fas fa-phone text-green-500 text-sm"})}),e.jsx("span",{className:"font-estedad-medium text-dark text-sm",children:n.phoneNumber})]}),e.jsxs("a",{href:`https://www.google.com/maps/dir/?api=1&destination=${t[0]},${t[1]}`,target:"_blank",rel:"noopener noreferrer",className:"mt-3 w-full main-btn flex items-center justify-center gap-2",children:[e.jsx("span",{children:"مسیریابی روی نقشه"}),e.jsx("i",{className:"fas fa-route text-xs"})]})]}),s[12]=n,s[13]=t,s[14]=x):x=s[14];let u;return s[15]!==c||s[16]!==x?(u=e.jsx("div",{className:"relative h-full min-h-[400px]",children:e.jsxs("div",{className:"relative z-20 h-full flex flex-col",children:[c,x]})}),s[15]=c,s[16]=x,s[17]=u):u=s[17],u}const B=a=>{const s=j.c(3);let n;s[0]===Symbol.for("react.memo_cache_sentinel")?(n=e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M5 7.5L10 12.5L15 7.5",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),s[0]=n):n=s[0];let i;return s[1]!==a?(i=e.jsx(A.DropdownIndicator,{...a,children:n}),s[1]=a,s[2]=i):i=s[2],i};function E(){const{mutateAsync:a,isPending:s}=$(),{data:n}=f(1,100),i=z.useMemo(()=>n?.data?.clinics?.map(t=>({value:t.id,label:t.name}))||[],[n?.data?.clinics]),r=async(t,l)=>{try{await a({name:t.name,email:t.email,phoneNumber:t.phone,subject:t.subject,message:t.message,clinicId:t.clinicId||null}),b("پیام شما با موفقیت ارسال شد"),l()}catch(o){console.log(o),y("خطایی رخ داده است")}};return e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6 md:p-8 border border-gray-100 h-full",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-2xl md:text-3xl font-estedad-bold text-dark mb-2",children:"پیام خود را ارسال کنید"}),e.jsx("p",{className:"text-paragray text-sm md:text-base",children:"فرم زیر را پر کنید تا در اسرع وقت با شما تماس بگیریم"})]}),e.jsx(w,{initialValues:{name:"",email:"",phone:"",subject:"",message:"",clinicId:null},onSubmit:(t,{resetForm:l})=>r(t,l),validationSchema:N({name:p().required("نام الزامی است"),email:p().email("ایمیل معتبر نیست"),phone:p().required("شماره الزامی است").test("is-valid-phone","شماره موبایل معتبر نمیباشد",t=>{try{return S(t),!0}catch(l){return console.log(l),!1}}),subject:p().required("موضوع الزامی است"),message:p().required("پیام الزامی است").min(10,"پیام باید حداقل 10 کاراکتر باشد"),clinicId:p().uuid().nullable()}),children:t=>e.jsx("form",{onSubmit:t.handleSubmit,className:"space-y-4",children:e.jsxs("div",{className:"md:grid xl:block  md:grid-cols-2  gap-6",children:[e.jsx(h,{placeholder:"نام",requiredText:!0,...t.getFieldProps("name"),errorMessage:t.touched.name&&t.errors.name?t.errors.name:null}),e.jsx(h,{placeholder:"ایمیل آدرس",optional:!0,inputType:"email",...t.getFieldProps("email"),errorMessage:t.touched.email&&t.errors.email?t.errors.email:null}),e.jsx(h,{placeholder:"شماره موبایل",requiredText:!0,inputType:"phone",...t.getFieldProps("phone"),errorMessage:t.touched.phone&&t.errors.phone?t.errors.phone:null}),e.jsx(h,{placeholder:"موضوع",requiredText:!0,...t.getFieldProps("subject"),errorMessage:t.touched.subject&&t.errors.subject?t.errors.subject:null}),e.jsxs("div",{children:[e.jsx(L,{options:i,value:i.find(l=>l.value===t.values.clinicId)||null,onChange:l=>{t.setFieldValue("clinicId",l?.value||null),t.setFieldTouched("clinicId",!0)},onBlur:()=>t.setFieldTouched("clinicId",!0),placeholder:"کلینیک را انتخاب کنید (اختیاری)",isClearable:!0,components:{DropdownIndicator:B},classNames:{control:()=>"!text-dark px-5 !min-h-[52px] !rounded-lg !border-2 !border-main-border-color !focus:outline-none h-full !cursor-pointer",option:({isFocused:l,isSelected:o})=>`px-3 py-2 cursor-pointer !text-lg border-r-6 ${o?"!bg-primary text-white !cursor-pointer":l?"!text-secondary !cursor-pointer":"bg-white !cursor-pointer"}`,menu:()=>"!mt-0 !rounded-t-none shadow-lg bg-white overflow-hidden",placeholder:()=>"!text-paragray font-estedad-light"}}),e.jsx("div",{className:"text-red-500 text-[10px] mr-4 mt-1 min-h-[20px]",children:t.touched.clinicId&&t.errors.clinicId?t.errors.clinicId:null})]}),e.jsx(v,{placeholder:"پیام",rows:4,requiredText:!0,className:"min-h-[120px] w-full",...t.getFieldProps("message"),errorMessage:t.touched.message&&t.errors.message?t.errors.message:null}),e.jsx("button",{type:"submit",className:" main-btn mt-6 col-span-2 justify-self-end",disabled:s,children:s?e.jsx("div",{className:"btn-loader"}):"ارسال پیام"})]})})})]})}function se(){const a=j.c(13),{data:s}=f(1,10);let n;a[0]!==s?.data?.clinics?(n=s?.data?.clinics||[],a[0]=s?.data?.clinics,a[1]=n):n=a[1];const i=n;let r;a[2]===Symbol.for("react.memo_cache_sentinel")?(r=e.jsx(C,{}),a[2]=r):r=a[2];let t,l,o,d;a[3]===Symbol.for("react.memo_cache_sentinel")?(t={opacity:0,y:30},l={opacity:1,y:0},o={duration:.6,ease:"easeOut"},d={once:!0,amount:.2},a[3]=t,a[4]=l,a[5]=o,a[6]=d):(t=a[3],l=a[4],o=a[5],d=a[6]);let m;a[7]===Symbol.for("react.memo_cache_sentinel")?(m=e.jsx("div",{className:"xl:col-span-4",children:e.jsx(g.div,{initial:t,whileInView:l,transition:o,viewport:d,className:"lg:sticky lg:top-8",children:e.jsx(E,{})})}),a[7]=m):m=a[7];let c;a[8]!==i?(c=e.jsx("section",{className:"py-12 bg-white",children:e.jsx("div",{className:"container mx-auto px-4",children:e.jsxs("div",{className:"grid xl:grid-cols-12 gap-8 ",children:[m,e.jsx("div",{className:"xl:col-span-8 flex flex-col gap-y-6 ",children:i.length>0?e.jsxs(g.div,{className:"grow h-full flex flex-col",initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},transition:{duration:.6,ease:"easeOut",delay:.2},viewport:{once:!0,amount:.2},children:[e.jsxs("div",{className:"mb-6 lg:mt-9",children:[e.jsx("h3",{className:"text-2xl md:text-3xl font-estedad-bold text-dark mb-2",children:"موقعیت کلینیک‌های ما"}),e.jsx("p",{className:"text-paragray text-sm md:text-base",children:"برای مشاهده موقعیت دقیق کلینیک‌ها روی نقشه کلیک کنید"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 grow ",children:i.map(Q)})]}):e.jsxs("div",{className:"text-center py-16 bg-gray-50 rounded-2xl",children:[e.jsx("i",{className:"fas fa-map-marker-alt text-4xl text-gray-400 mb-4"}),e.jsx("p",{className:"text-paragray font-estedad-light text-lg",children:"کلینیکی ثبت نشده است"})]})})]})})}),a[8]=i,a[9]=c):c=a[9];let x;a[10]===Symbol.for("react.memo_cache_sentinel")?(x=e.jsx("section",{className:" ",children:e.jsx(D,{})}),a[10]=x):x=a[10];let u;return a[11]!==c?(u=e.jsxs(e.Fragment,{children:[r,c,x]}),a[11]=c,a[12]=u):u=a[12],u}function Q(a,s){return e.jsx(g.div,{className:"flex flex-col ",initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.5,delay:s*.1},viewport:{once:!0,amount:.2},children:e.jsx("div",{className:"grow bg-white rounded-2xl shadow-md hover:shadow-xl transition-all duration-300 overflow-hidden border border-gray-100",children:e.jsx(R,{clinic:a})})},a.id)}export{se as default};
