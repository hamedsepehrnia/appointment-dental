import{j as e,c as D}from"./query-vendor-DvaUDqTV.js";import{u as C,a as u}from"./react-vendor-dTsWsAAn.js";import{c as I,s as T,b as S}from"./index-J2TYnO22.js";import{u as M}from"./useAdminDashboardHeader-CFWWO3br.js";import{u as R,a as A,I as E}from"./InsuranceManagementForm-ycspYtA4.js";import{A as L}from"./AdminPagination-C9xjNttd.js";import{T as P}from"./TableContainer-DH9kHNNa.js";import{T as F,D as $}from"./DeleteModal-DTbIAagN.js";import{s as H,f as O}from"./helpers-DOyc9qlM.js";import{S as _}from"./SectionContainer-B65ywGCw.js";import"./redux-vendor-5gwm_VuO.js";import"./ui-vendor-B68-Q-v-.js";import"./form-vendor--jwUxY8R.js";import"./motion-vendor-CQyDv_CV.js";import"./CustomTextArea-C__Mc83G.js";function q(h){const s=I.c(15),{insurances:m,isLoadingInsurances:p,page:i,onDeleteClick:d,onRefetch:a,isRefetching:f}=h,o=f===void 0?!1:f,g=C();let r;s[0]!==o||s[1]!==a?(r=a&&e.jsx("div",{className:"mb-4 flex justify-end",children:e.jsxs("button",{onClick:a,disabled:o,className:"px-4 py-2 rounded-lg text-sm font-estedad-medium bg-primary/10 text-primary hover:bg-primary hover:text-white transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",title:"بروزرسانی لیست",children:[o?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-primary border-t-transparent"}):e.jsx("i",{className:"fas fa-sync-alt"}),"بروزرسانی"]})}),s[0]=o,s[1]=a,s[2]=r):r=s[2];let c;s[3]===Symbol.for("react.memo_cache_sentinel")?(c=e.jsx("thead",{className:"border-b border-main-border-color ",children:e.jsxs("tr",{className:"*:text-right *:p-4.5 *:text-nowrap",children:[e.jsx("th",{children:"ردیف"}),e.jsx("th",{children:"نام سازمان"}),e.jsx("th",{children:"توضیحات"}),e.jsx("th",{children:"وب‌سایت"}),e.jsx("th",{children:"تماس"}),e.jsx("th",{children:"ترتیب"}),e.jsx("th",{children:"وضعیت"}),e.jsx("th",{children:"تاریخ ایجاد"}),e.jsx("th",{children:"عملیات"})]})}),s[3]=c):c=s[3];let n;s[4]!==m||s[5]!==p||s[6]!==g||s[7]!==d||s[8]!==i?(n=p?e.jsx(F,{rows:5,columns:9}):m.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:9,className:"text-center p-8 font-estedad-light",children:"سازمان بیمه‌ای یافت نشد"})}):m.map((t,N)=>e.jsxs("tr",{className:"hover:bg-purple-400/10 text-dark *:p-4.5",children:[e.jsx("td",{className:"font-estedad-light text-center",children:(i-1)*5+N+1}),e.jsx("td",{className:"",children:e.jsxs("div",{className:"flex items-center gap-3",children:[t.logo?e.jsx("img",{src:`${t.logo}`,alt:t.name,className:"w-12 h-12 rounded-full object-cover shrink-0"}):e.jsx("div",{className:"w-12 h-12 rounded-full bg-gray-200 flex items-center justify-center shrink-0",children:e.jsx("i",{className:"far fa-building text-gray-400"})}),e.jsx("p",{className:"font-estedad-light line-clamp-2 max-w-[300px] min-w-[220px]",children:t.name})]})}),e.jsx("td",{className:"text-dark font-estedad-light",children:t.description?e.jsx("span",{className:"line-clamp-2 max-w-[300px] min-w-[220px]",children:H(t.description)}):e.jsx("span",{className:"text-paragray",children:"-"})}),e.jsx("td",{className:"text-dark font-estedad-light",children:t.website?e.jsx("a",{href:t.website,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline line-clamp-2 max-w-[260px] min-w-[200px]",children:t.website}):e.jsx("span",{className:"text-paragray",children:"-"})}),e.jsx("td",{className:"text-dark font-estedad-light",children:e.jsxs("div",{className:"space-y-1 line-clamp-2  min-w-[220px]",children:[t.phoneNumber&&e.jsxs("div",{className:"text-sm",children:[e.jsx("i",{className:"fas fa-phone text-paragray ml-1"}),t.phoneNumber]}),t.email&&e.jsxs("div",{className:"text-sm flex items-center gap-1 line-clamp-2",children:[e.jsx("i",{className:"far fa-envelope text-paragray ml-1"}),t.email]}),!t.phoneNumber&&!t.email&&e.jsx("span",{className:"text-paragray",children:"-"})]})}),e.jsx("td",{className:"text-dark font-estedad-light text-center",children:t.order}),e.jsx("td",{className:"text-dark font-estedad-light",children:t.published?e.jsx("span",{className:"px-2 py-1 text-xs rounded-full bg-green-100 text-green-700 text-nowrap",children:"منتشر شده"}):e.jsx("span",{className:"px-2 py-1 text-xs rounded-full bg-yellow-100 text-yellow-700 text-nowrap",children:"پیش‌نویس"})}),e.jsx("td",{className:"text-dark font-estedad-light text-nowrap",children:O(new Date(t.createdAt||new Date))}),e.jsx("td",{className:"",children:e.jsxs("div",{className:"flex items-center  gap-2",children:[e.jsx("button",{onClick:()=>{g(`/admin/insurances-management/edit/${t.id}`)},className:"p-1.5 rounded-full text-secondary bg-secondary/20 hover:bg-secondary hover:text-white transition",title:"ویرایش",children:e.jsx("i",{className:"far fa-edit"})}),e.jsx("button",{onClick:()=>d(t.id,t.name),className:"p-1.5 rounded-full text-red-500 bg-red-500/20 hover:bg-red-500 hover:text-white transition",title:"حذف",children:e.jsx("i",{className:"far fa-trash-alt"})})]})})]},t.id)),s[4]=m,s[5]=p,s[6]=g,s[7]=d,s[8]=i,s[9]=n):n=s[9];let l;s[10]!==n?(l=e.jsx(P,{withBg:!0,withMargin:!0,children:e.jsxs("table",{className:"w-full ",children:[c,e.jsx("tbody",{className:"divide-y divide-main-border-color",children:n})]})}),s[10]=n,s[11]=l):l=s[11];let x;return s[12]!==r||s[13]!==l?(x=e.jsxs(e.Fragment,{children:[r,l]}),s[12]=r,s[13]=l,s[14]=x):x=s[14],x}function ae(){const{setHeaderConfig:h}=M(),[s,m]=u.useState(1),[p,i]=u.useState(!1),[d,a]=u.useState(null),[f,o]=u.useState(!1),g=D(),{mutateAsync:r}=R(),{data:c,isLoading:n,isPending:l,refetch:x,isFetching:t}=A(s,5,void 0);u.useEffect(()=>(h({title:"مدیریت سازمان‌های بیمه"}),()=>{h({title:void 0,backButton:!1})}),[h]);const N=(j,b)=>{a({id:j,name:b}),i(!0)},y=async()=>{if(d){o(!0);try{await r(d.id),T("سازمان بیمه با موفقیت حذف شد"),g.invalidateQueries({queryKey:["insurances"]}),i(!1),a(null)}catch(j){const b=j?.response?.data?.message||"خطایی در حذف سازمان بیمه رخ داد";S(b)}finally{o(!1)}}},w=()=>{f||(i(!1),a(null))},v=c?.data?.organizations||[],k=c?.meta;return e.jsxs("main",{children:[e.jsxs(_,{children:[e.jsx("h5",{className:"main-header ",children:"لیست سازمان‌های بیمه"}),e.jsx(q,{insurances:v,isLoadingInsurances:n||l,page:s,onDeleteClick:N,onRefetch:x,isRefetching:t}),e.jsx("div",{className:"mb-12 mt-6",children:e.jsx(L,{meta:k,onPageChange:j=>m(j)})}),e.jsx("hr",{className:"my-6 border-2 rounded-4xl border-gray-500"}),e.jsx(E,{})]}),e.jsx($,{isOpen:p,onClose:w,onConfirm:y,title:"حذف سازمان بیمه",message:`آیا از حذف سازمان بیمه "${d?.name}" اطمینان دارید؟ این عمل غیرقابل بازگشت است.`,confirmText:"حذف",cancelText:"انصراف",isLoading:f})]})}export{ae as default};
