import{r as u,j as b}from"./react-core-DkX7OQ4Q.js";import{a5 as C,a6 as E,a7 as f,a8 as x,a9 as Q,aa as _,ab as M}from"./vendor-BGjx4oOA.js";var p=u.createContext(void 0),g=e=>{const t=u.useContext(p);if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},j=({client:e,children:t})=>(u.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),b.jsx(p.Provider,{value:e,children:t})),R=u.createContext(!1),d=()=>u.useContext(R);R.Provider;function w(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var I=u.createContext(w()),O=()=>u.useContext(I),T=(e,t)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&(t.isReset()||(e.retryOnMount=!1))},P=e=>{u.useEffect(()=>{e.clearReset()},[e])},q=({result:e,errorResetBoundary:t,throwOnError:o,query:s,suspense:n})=>e.isError&&!t.isReset()&&!e.isFetching&&s&&(n&&e.data===void 0||C(o,[e.error,s])),N=e=>{if(e.suspense){const o=n=>n==="static"?n:Math.max(n??1e3,1e3),s=e.staleTime;e.staleTime=typeof s=="function"?(...n)=>o(s(...n)):o(s),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3))}},B=(e,t)=>e.isLoading&&e.isFetching&&!t,k=(e,t)=>e?.suspense&&t.isPending,m=(e,t,o)=>t.fetchOptimistic(e).catch(()=>{o.clearReset()});function S(e,t,o){const s=d(),n=O(),i=g(),r=i.defaultQueryOptions(e);i.getDefaultOptions().queries?._experimental_beforeQuery?.(r),r._optimisticResults=s?"isRestoring":"optimistic",N(r),T(r,n),P(n);const l=!i.getQueryCache().get(r.queryHash),[a]=u.useState(()=>new t(i,r)),c=a.getOptimisticResult(r),y=!s&&e.subscribed!==!1;if(u.useSyncExternalStore(u.useCallback(h=>{const v=y?a.subscribe(E.batchCalls(h)):f;return a.updateResult(),v},[a,y]),()=>a.getCurrentResult(),()=>a.getCurrentResult()),u.useEffect(()=>{a.setOptions(r)},[r,a]),k(r,c))throw m(r,a,n);if(q({result:c,errorResetBoundary:n,throwOnError:r.throwOnError,query:i.getQueryCache().get(r.queryHash),suspense:r.suspense}))throw c.error;return i.getDefaultOptions().queries?._experimental_afterQuery?.(r,c),r.experimental_prefetchInRender&&!x&&B(c,s)&&(l?m(r,a,n):i.getQueryCache().get(r.queryHash)?.promise)?.catch(f).finally(()=>{a.updateResult()}),r.notifyOnChangeProps?c:a.trackResult(c)}function F(e,t){return S(e,Q)}function D(e,t){const o=g(),[s]=u.useState(()=>new _(o,e));u.useEffect(()=>{s.setOptions(e)},[s,e]);const n=u.useSyncExternalStore(u.useCallback(r=>s.subscribe(E.batchCalls(r)),[s]),()=>s.getCurrentResult(),()=>s.getCurrentResult()),i=u.useCallback((r,l)=>{s.mutate(r,l).catch(f)},[s]);if(n.error&&C(s.options.throwOnError,[n.error]))throw n.error;return{...n,mutate:i,mutateAsync:n.mutate}}function A(e,t){return S(e,M)}export{j as Q,D as a,g as b,A as c,F as u};
