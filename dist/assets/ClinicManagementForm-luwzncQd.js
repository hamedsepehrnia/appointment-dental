import{c as x,j as r}from"./query-vendor-DvaUDqTV.js";import{c as N,b as u,a as i,F as y}from"./form-vendor--jwUxY8R.js";import{w,x as j,f as C,C as l,s as c,b as T}from"./index-J2TYnO22.js";import{C as q}from"./CustomTextArea-C__Mc83G.js";import{u as F}from"./react-vendor-dTsWsAAn.js";function B({clinic:a}){const p=F(),n=x(),{mutateAsync:g}=w(),{mutateAsync:h}=j(),o=!!a?.id,m=N({name:i().required("نام کلینیک الزامی است"),address:i().required("آدرس الزامی است"),phoneNumber:i().required("شماره تلفن الزامی است").test("is-valid-phone","شماره تلفن معتبر نیست",e=>{try{return C(e),!0}catch(s){return console.log(s),!1}}),description:i(),latitude:u().nullable().min(-90,"عرض جغرافیایی باید بین -90 تا 90 باشد").max(90,"عرض جغرافیایی باید بین -90 تا 90 باشد"),longitude:u().nullable().min(-180,"طول جغرافیایی باید بین -180 تا 180 باشد").max(180,"طول جغرافیایی باید بین -180 تا 180 باشد")}),b=async(e,s)=>{try{const t={name:e.name,address:e.address,phoneNumber:e.phoneNumber};if(e.description&&(t.description=e.description),e.latitude!==null&&e.latitude!==void 0&&(t.latitude=e.latitude),e.longitude!==null&&e.longitude!==void 0&&(t.longitude=e.longitude),o&&a?.id)await h({id:a.id,data:t}),c("کلینیک با موفقیت ویرایش شد"),n.invalidateQueries({queryKey:["clinics"]}),n.invalidateQueries({queryKey:["clinic"]}),p("/admin/clinics-management");else{await g(t),c("کلینیک با موفقیت ایجاد شد"),s(),n.invalidateQueries({queryKey:["clinics"]}),n.invalidateQueries({queryKey:["clinic"]});const d=document.querySelector(".overflow-auto");d?d.scrollTo({top:0,behavior:"smooth"}):window.scrollTo({top:0,behavior:"smooth"})}}catch(t){const d=t?.response?.data?.message||(o?"خطایی در ویرایش کلینیک رخ داد":"خطایی در ایجاد کلینیک رخ داد");T(d)}};return r.jsx(y,{initialValues:{name:a?.name||"",address:a?.address||"",phoneNumber:a?.phoneNumber||"",description:a?.description||"",latitude:a?.latitude??null,longitude:a?.longitude??null},validationSchema:m,onSubmit:async(e,{resetForm:s})=>{await b({name:e.name,address:e.address,phoneNumber:e.phoneNumber,description:e.description,latitude:e.latitude===null||e.latitude===void 0?null:Number(e.latitude),longitude:e.longitude===null||e.longitude===void 0?null:Number(e.longitude)},s)},children:e=>r.jsxs("form",{onSubmit:e.handleSubmit,className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 ",children:[r.jsx(l,{labelText:"نام کلینیک",placeholder:"نام کلینیک را وارد کنید",className:"bg-white",requiredText:!0,...e.getFieldProps("name"),errorMessage:e.touched.name&&e.errors.name?e.errors.name:null}),r.jsx(l,{labelText:"شماره تماس",placeholder:"شماره تماس را وارد کنید",requiredText:!0,className:"bg-white",...e.getFieldProps("phoneNumber"),inputType:"phone",errorMessage:e.touched.phoneNumber&&e.errors.phoneNumber?e.errors.phoneNumber:null})]}),r.jsx(l,{labelText:"آدرس",placeholder:"آدرس کلینیک را وارد کنید",requiredText:!0,className:"bg-white",...e.getFieldProps("address"),errorMessage:e.touched.address&&e.errors.address?e.errors.address:null}),r.jsx(q,{labelText:"توضیحات",placeholder:"توضیحات کلینیک را وارد کنید",optional:!0,rows:4,className:"bg-white",...e.getFieldProps("description"),errorMessage:e.touched.description&&e.errors.description?e.errors.description:null}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 ",children:[r.jsx(l,{labelText:"عرض جغرافیایی (Latitude)",placeholder:"مثال: 35.6892",optional:!0,className:"bg-white",name:"latitude",type:"number",step:"any",value:e.values.latitude===null?"":e.values.latitude?.toString()||"",onChange:s=>{const t=s.target.value;e.setFieldValue("latitude",t===""?null:parseFloat(t))},onBlur:e.handleBlur,errorMessage:e.touched.latitude&&e.errors.latitude?e.errors.latitude:null}),r.jsx(l,{labelText:"طول جغرافیایی (Longitude)",placeholder:"مثال: 51.3890",optional:!0,className:"bg-white",name:"longitude",type:"number",step:"any",value:e.values.longitude===null?"":e.values.longitude?.toString()||"",onChange:s=>{const t=s.target.value;e.setFieldValue("longitude",t===""?null:parseFloat(t))},onBlur:e.handleBlur,errorMessage:e.touched.longitude&&e.errors.longitude?e.errors.longitude:null})]}),r.jsx("div",{className:"flex justify-end mt-6",children:r.jsxs("button",{type:"submit",className:"purple-btn flex items-center gap-2",disabled:e.isSubmitting,children:[o?"ویرایش کلینیک":"ایجاد کلینیک",e.isSubmitting&&r.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-white border-t-transparent"})]})})]})})}export{B as C};
