import{r as p,j as e}from"./react-core-DkX7OQ4Q.js";import{B as y}from"./Breadcrumb-BOQPnB1t.js";import{x as v,y as N,z as w,e as _,E as A,G as E,i as c,H as F,s as I}from"./index-DUiqV2No.js";import{u as k}from"./redux-T8ZA8Ca5.js";import{u as U,a as C,b as f,O as D}from"./react-router-CdfMEooj.js";import{m as x}from"./motion-DV3VySaH.js";import"./vendor-BGjx4oOA.js";import"./map-dgLBSVMX.js";import"./editor-DLslrAMc.js";import"./query-x6gLKhnn.js";import"./ui-CioiL3KZ.js";import"./forms-CxDKTD82.js";import"./swiper-CgWgy0A2.js";import"./seo-D35OfG1v.js";function J(){const s=v(a=>a.user.data),u=U(),o=k(),h=C(),{mutateAsync:g}=N(),l=p.useRef(null),[n,m]=p.useState(!1),{mutateAsync:b}=w(),j=async a=>{const r=a.target.files?.[0];if(r){if(!r.type.startsWith("image/")){c("لطفاً یک فایل تصویری انتخاب کنید");return}if(r.size>5*1024*1024){c("حجم فایل نباید بیشتر از 5 مگابایت باشد");return}try{m(!0);const i=new FormData;i.append("profileImage",r);const t=await b(i);if(t?.data?.user){const d={...t.data.user,role:s?.role||t.data.user.role};o(F(d))}I("عکس پروفایل با موفقیت به‌روزرسانی شد"),l.current&&(l.current.value="")}catch(i){const t=i,d=typeof t.response?.data=="object"&&t.response?.data?.message?t.response.data.message:"خطا در آپلود عکس. لطفاً دوباره تلاش کنید.";c(d),console.error("خطا در آپلود عکس:",i)}finally{m(!1)}}};return e.jsxs(e.Fragment,{children:[e.jsx(y,{}),e.jsx("section",{className:"pt-2 pb-4 overflow-x-hidden",children:e.jsx("div",{className:"container mx-auto px-4",children:e.jsxs("div",{className:"grid lg:grid-cols-4 gap-4",children:[e.jsxs(x.div,{className:"lg:col-span-1",initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.6,ease:"easeOut"},children:[e.jsxs("div",{className:`bg-[linear-gradient(45deg,_#E8F4F4_0%,_rgba(212,232,232,0.85)_28.13%,_rgba(245,232,212,0.90)_79.75%,_#FAF0E0_100%)]
 rounded-xl shadow-sm p-4 mb-3 text-center `,children:[e.jsxs("div",{className:"relative w-20 h-20 mx-auto mb-2",children:[e.jsx("img",{src:s?.profileImage?_(s.profileImage):s?.gender==="FEMALE"?"/images/female-user.jpeg":"/images/male-user.jpeg",alt:"user",className:"w-full h-full rounded-full object-fill"}),n&&e.jsx("div",{className:"absolute inset-0 bg-black/50 rounded-full flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-white"})}),e.jsx("label",{htmlFor:"profile_photo",className:`absolute bottom-0 left-0 w-8 h-8 bg-white hover:bg-primary rounded-full flex items-center justify-center hover:text-white cursor-pointer transition shadow-sm ${n?"opacity-50 cursor-not-allowed":""}`,children:e.jsx("i",{className:"fas fa-camera text-xs"})}),e.jsx("input",{id:"profile_photo",ref:l,type:"file",accept:"image/*",className:"hidden",onChange:j,disabled:n})]}),e.jsxs("h4",{className:"text-dark font-estedad-verybold text-lg mb-1",children:[s?.firstName," ",s?.lastName]}),e.jsx("p",{className:"text-paragray font-estedad-light text-xs",children:s?.phoneNumber})]}),e.jsx("div",{className:"",children:e.jsxs("ul",{className:"space-y-2",children:[e.jsx("li",{className:"border border-[#1b1d1f14] overflow-hidden rounded-xl",children:e.jsxs(f,{to:"/dashboard/profile",className:({isActive:a})=>` ${(a||u.pathname.startsWith("/dashboard/profile"))&&"text-white bg-primary hover:bg-primary hover:text-white"} flex items-center justify-between py-2.5 px-4 bg-[#d4af370d] hover:bg-gray-100 transition text-dark font-estedad-semibold text-sm`,children:[e.jsx("span",{children:"پروفایل من"}),e.jsx("i",{className:"fas fa-angle-left text-xs"})]})}),e.jsx("li",{className:"border border-[#1b1d1f14] overflow-hidden rounded-xl",children:e.jsxs(f,{to:"/dashboard/turns",className:({isActive:a})=>` ${a&&"text-white bg-primary hover:bg-primary hover:text-white"} flex items-center justify-between py-2.5 px-4 bg-[#d4af370d] hover:bg-gray-100 transition text-dark font-estedad-semibold text-sm`,children:[e.jsx("span",{children:"نوبت ها"}),e.jsx("i",{className:"fas fa-angle-left text-xs"})]})}),e.jsx("li",{className:"border border-[#1b1d1f14] overflow-hidden rounded-xl",children:e.jsxs("button",{onClick:async()=>{await g(),console.log("hello"),o(A()),o(E()),h("/home",{replace:!0})},className:"flex items-center justify-between py-2.5 px-4 bg-secondary/80 hover:bg-secondary text-white transition w-full text-sm",children:[e.jsx("span",{children:"خروج"}),e.jsx("i",{className:"fas fa-angle-left text-xs"})]})})]})})]}),e.jsx(x.div,{className:"lg:col-span-3",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.6,ease:"easeOut"},children:e.jsx(D,{})})]})})})]})}export{J as default};
