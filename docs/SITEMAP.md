# Sitemap داینامیک

## توضیحات

این سیستم یک **sitemap.xml داینامیک** تولید می‌کند که شامل تمام صفحات سایت می‌شود:

### صفحات استاتیک
- `/home`
- `/about-us`
- `/contact`
- `/doctors`
- `/services`
- `/blog`
- `/gallery`
- `/faq`
- `/become-doctor`

### صفحات داینامیک
- تمام پزشکان: `/doctors/{slug}`
- تمام خدمات: `/services/{slug}`
- تمام مقالات منتشر شده: `/blog/{slug}`

## نحوه استفاده

### 1. دسترسی به Sitemap
Sitemap در آدرس زیر در دسترس است:
```
GET /sitemap.xml
```

### 2. تنظیمات محیطی
برای تعیین آدرس سایت، متغیر محیطی `SITE_URL` را تنظیم کنید:

```env
SITE_URL=https://yourdomain.com
```

اگر این متغیر تنظیم نشده باشد، سیستم به صورت خودکار از `req.protocol + "://" + req.get("host")` استفاده می‌کند.

### 3. Robots.txt
در فایل `robots.txt` آدرس sitemap را به صورت زیر تنظیم کنید:

```
Sitemap: https://yourdomain.com/sitemap.xml
```

## ساختار Sitemap

هر URL در sitemap شامل اطلاعات زیر است:
- **loc**: آدرس کامل صفحه
- **lastmod**: تاریخ آخرین به‌روزرسانی (برای صفحات داینامیک از `updatedAt` استفاده می‌شود)
- **changefreq**: فرکانس تغییرات (daily, weekly, monthly)
- **priority**: اولویت صفحه (0.0 تا 1.0)

## اولویت‌ها

- صفحات اصلی (home): `1.0`
- صفحات مهم (doctors, services, blog): `0.9`
- صفحات جزئیات (doctor details, service details): `0.8`
- مقالات: `0.7`
- صفحات دیگر: `0.6-0.8`

## به‌روزرسانی خودکار

Sitemap به صورت **داینامیک** تولید می‌شود، یعنی:
- هر بار که درخواست می‌شود، از دیتابیس خوانده می‌شود
- صفحات جدید به صورت خودکار اضافه می‌شوند
- صفحات حذف شده به صورت خودکار حذف می‌شوند

## نکات مهم

1. **فقط مقالات منتشر شده** در sitemap قرار می‌گیرند
2. **فقط صفحاتی که slug دارند** در sitemap قرار می‌گیرند
3. برای بهبود عملکرد، می‌توانید caching اضافه کنید
4. موتورهای جستجو معمولاً هر چند روز یکبار sitemap را بررسی می‌کنند

## بهبود عملکرد (اختیاری)

برای سایت‌های بزرگ، می‌توانید:
1. Caching اضافه کنید (مثلاً 1 ساعت)
2. Sitemap را به چند فایل تقسیم کنید (sitemap index)
3. از background job برای تولید sitemap استفاده کنید

